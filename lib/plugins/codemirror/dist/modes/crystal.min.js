(function(a){if(typeof exports=="object"&&typeof module=="object")a(require("../../lib/codemirror"));else if(typeof define=="function"&&define.amd)define(["../../lib/codemirror"],a);else a(CodeMirror)})(function(a){"use strict";a.defineMode("crystal",function(a){function b(a,b){return new RegExp((b?"":"^")+"(?:"+a.join("|")+")"+(b?"$":"\\b"))}function c(a,b,c){c.tokenize.push(a);return a(b,c)}var d=/^(?:[-+\/%|&^]|\*\*?|[<>]{2})/;var e=/^(?:[=!]~|===|<=>|[<>=!]=?|[|&]{2}|~)/;var f=/^(?:\[\][?=]?)/;var g=/^(?:\.(?:\.{2})?|->|[?:])/;var h=/^[a-z_\u009F-\uFFFF][a-zA-Z0-9_\u009F-\uFFFF]*/;var i=/^[A-Z_\u009F-\uFFFF][a-zA-Z0-9_\u009F-\uFFFF]*/;var j=b(["abstract","alias","as","asm","begin","break","case","class","def","do","else","elsif","end","ensure","enum","extend","for","fun","if","ifdef","include","instance_sizeof","lib","macro","module","next","of","out","pointerof","private","protected","rescue","return","require","sizeof","struct","super","then","type","typeof","union","unless","until","when","while","with","yield","__DIR__","__FILE__","__LINE__"]);var k=b(["true","false","nil","self"]);var l=["def","fun","macro","class","module","struct","lib","enum","union","if","unless","case","while","until","begin","then","do","for","ifdef"];var m=b(l);var n=["end","else","elsif","rescue","ensure"];var o=b(n);var p=["\\)","\\}","\\]"];var q=new RegExp("^(?:"+p.join("|")+")$");var r={def:x,fun:x,macro:w,"class":y,module:y,struct:y,lib:y,"enum":y,union:y};var s={"[":"]","{":"}","(":")","<":">"};function t(a,b){if(a.eatSpace()){return null}if(b.lastToken!="\\"&&a.match("{%",false)){return c(v("%","%"),a,b)}if(b.lastToken!="\\"&&a.match("{{",false)){return c(v("{","}"),a,b)}if(a.peek()=="#"){a.skipToEnd();return"comment"}var l;if(a.match(h)){a.eat(/[?!]/);l=a.current();if(a.eat(":")){return"atom"}else if(b.lastToken=="."){return"property"}else if(j.test(l)){if(b.lastToken!="abstract"&&m.test(l)){if(!(l=="fun"&&b.blocks.indexOf("lib")>=0)){b.blocks.push(l);b.currentIndent+=1}}else if(o.test(l)){b.blocks.pop();b.currentIndent-=1}if(r.hasOwnProperty(l)){b.tokenize.push(r[l])}return"keyword"}else if(k.test(l)){return"atom"}return"variable"}if(a.eat("@")){if(a.peek()=="["){return c(u("[","]","meta"),a,b)}a.eat("@");a.match(h)||a.match(i);return"variable-2"}if(a.eat("$")){a.eat(/[0-9]+|\?/)||a.match(h)||a.match(i);return"variable-3"}if(a.match(i)){return"tag"}if(a.eat(":")){if(a.eat('"')){return c(z('"',"atom",false),a,b)}else if(a.match(h)||a.match(i)||a.match(d)||a.match(e)||a.match(f)){return"atom"}a.eat(":");return"operator"}if(a.eat('"')){return c(z('"',"string",true),a,b)}if(a.peek()=="%"){var n="string";var p=true;var q;if(a.match("%r")){n="string-2";q=a.next()}else if(a.match("%w")){p=false;q=a.next()}else{if(q=a.match(/^%([^\w\s=])/)){q=q[1]}else if(a.match(/^%[a-zA-Z0-9_\u009F-\uFFFF]*/)){return"meta"}else{return"operator"}}if(s.hasOwnProperty(q)){q=s[q]}return c(z(q,n,p),a,b)}if(a.eat("'")){a.match(/^(?:[^']|\\(?:[befnrtv0'"]|[0-7]{3}|u(?:[0-9a-fA-F]{4}|\{[0-9a-fA-F]{1,6}\})))/);a.eat("'");return"atom"}if(a.eat("0")){if(a.eat("x")){a.match(/^[0-9a-fA-F]+/)}else if(a.eat("o")){a.match(/^[0-7]+/)}else if(a.eat("b")){a.match(/^[01]+/)}return"number"}if(a.eat(/\d/)){a.match(/^\d*(?:\.\d+)?(?:[eE][+-]?\d+)?/);return"number"}if(a.match(d)){a.eat("=");return"operator"}if(a.match(e)||a.match(g)){return"operator"}if(l=a.match(/[({[]/,false)){l=l[0];return c(u(l,s[l],null),a,b)}if(a.eat("\\")){a.next();return"meta"}a.next();return null}function u(a,b,c,d){return function(e,f){if(!d&&e.match(a)){f.tokenize[f.tokenize.length-1]=u(a,b,c,true);f.currentIndent+=1;return c}var g=t(e,f);if(e.current()===b){f.tokenize.pop();f.currentIndent-=1;g=c}return g}}function v(a,b,c){return function(d,e){if(!c&&d.match("{"+a)){e.currentIndent+=1;e.tokenize[e.tokenize.length-1]=v(a,b,true);return"meta"}if(d.match(b+"}")){e.currentIndent-=1;e.tokenize.pop();return"meta"}return t(d,e)}}function w(a,b){if(a.eatSpace()){return null}var c;if(c=a.match(h)){if(c=="def"){return"keyword"}a.eat(/[?!]/)}b.tokenize.pop();return"def"}function x(a,b){if(a.eatSpace()){return null}if(a.match(h)){a.eat(/[!?]/)}else{a.match(d)||a.match(e)||a.match(f)}b.tokenize.pop();return"def"}function y(a,b){if(a.eatSpace()){return null}a.match(i);b.tokenize.pop();return"def"}function z(a,b,c){return function(d,e){var f=false;while(d.peek()){if(!f){if(d.match("{%",false)){e.tokenize.push(v("%","%"));return b}if(d.match("{{",false)){e.tokenize.push(v("{","}"));return b}if(c&&d.match("#{",false)){e.tokenize.push(u("#{","}","meta"));return b}var g=d.next();if(g==a){e.tokenize.pop();return b}f=g=="\\"}else{d.next();f=false}}return b}}return{startState:function(){return{tokenize:[t],currentIndent:0,lastToken:null,blocks:[]}},token:function(a,b){var c=b.tokenize[b.tokenize.length-1](a,b);var d=a.current();if(c&&c!="comment"){b.lastToken=d}return c},indent:function(b,c){c=c.replace(/^\s*(?:\{%)?\s*|\s*(?:%\})?\s*$/g,"");if(o.test(c)||q.test(c)){return a.indentUnit*(b.currentIndent-1)}return a.indentUnit*b.currentIndent},fold:"indent",electricInput:b(p.concat(n),true),lineComment:"#"}});a.defineMIME("text/x-crystal","crystal")});
//# sourceMappingURL=crystal.min.js.map