===== HWC 显示合成 =====

----
我们通常看到的平板电脑的显示界面都是几个图层合成显示的结果，比如一个启动器界面一般就包括三层：背景壁纸、应用图标和系统通知栏。

一般来说，系统会调用OpenGL来做合成，但GPU工作任务重会很耗电，对平板的续航体验造成影响，所以系统也可以直接调用显示硬件DE（display engine）来做合成，也就是今天谈的HWC (Hardware Composer)，硬件合成，安卓显示系统里面的一种显示机制。

下图简单体现了这两种合成方式的区别：

在第一种情况中，四个图层全部使用OpenGL来合成，合成结果会传给DDR内存中，最终显示到平板屏幕上；在第二种情况下，Layer 1/2/3直接采用DE硬件合成，无需传到DDR就可直接显示到平板屏幕上。

相比GPU合成，硬件合成的显示机制减少了GPU的工作量，减少了DDR读写次数，从而大幅降低了系统功耗和系统带宽需求。在使用显示硬件进行合成时，GPU可以解放出来去做其他的图形处理工作，进一步提升系统性能。相对比GPU合成，DE硬件合成在处理有覆盖图层的情况时也更有优势。假如Layer1 和Layer2有一部分覆盖，GPU合成时会老老实实地将Layer 1和Layer2各读取一次，DE硬件合成则更加智能，覆盖的部分只读一次，显示速度更快。